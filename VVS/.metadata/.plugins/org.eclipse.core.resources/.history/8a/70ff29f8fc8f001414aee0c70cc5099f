package com.vvs.webserver;

import java.io.OutputStream;
import java.nio.file.Path;
import java.sql.Timestamp;
import java.util.Date;
import java.util.StringTokenizer;

public class HttpResponse {
	private String response_;
	private String httpCode_;
	private String date_;
	private String serverName_;
	private String contentLenght_;
	private String contentType_;
	
	public HttpResponse (String request, Path base) {
		StringTokenizer tokenizer = new StringTokenizer(request);
		
		String method = tokenizer.nextToken();
		switch (method) {
			case "GET":
				int beginIndex = 0;
				int endIndex;
				String path = tokenizer.nextToken();
				if (path.contains("://")) {
					beginIndex = path.indexOf("/", path.indexOf("://") + 3) + 1;
				}
				else if (path.startsWith("/")) {
					beginIndex = 1;
				}
				
				endIndex = path.indexOf("?");
				if (-1 == endIndex) {
					endIndex = path.length();
				}
				path = path.substring(beginIndex, endIndex);
				
				
				break;
			default :
				response_ = "HTTP/1.1 501 Not Implemented\r\n" +
							"Date: " + new Timestamp(new Date().getTime()).toString() + "\r\n" +
							"Server: vss webserver\r\n" +
							"Content-Length: 287\r\n" +
							"Content-Type: text/html; charset=iso-8859-1\r\n" +
							"Connection: Closed\r\n" +
							"\r\n" +
							"<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">" +
							"<html>" +
							"<head>" +
								"<title>501 Not implemented</title>" +
							"</head>" +
							"<body>" +
								"<h1>Not implemented</h1>" +
								"<p>Your browser sent a http request method that is not supported by this webserver.<p>" +
								"<p>Please use only HTTP GET!</p>" +
							"</body>" +
							"</html>";
				
		}
	}
	
	public void send(OutputStream out) {
		
	}
}
